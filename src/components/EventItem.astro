---
export interface Props {
  event: any;
  actionLabel?: string;
}
const { event, actionLabel = "Entradas" } = Astro.props;

function formatDate(dateStr: string) {
  const d = new Date(dateStr);
  return d.toLocaleDateString("es-ES", {
    day: "numeric",
    month: "long",
    year: "numeric",
  });
}

function displayedDate() {
  if (event.dateRange) return event.dateRange;
  if (event.occurrences && event.occurrences.length) {
    const last = event.occurrences[event.occurrences.length - 1];
    return formatDate(last.date);
  }
  return "";
}
---

<div class="border-b border-gray-200 pb-6">
  <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
    <div class="flex-1">
      <div class="flex  justify-between md:justify-start gap-3 mb-2 items-center">
        <h3 class="text-2xl font-semibold text-gray-900">{event.title}</h3>
        <span class="text-lg text-gray-500">{event.composer}</span>
      </div>
      <p class="text-gray-600 mb-1 text-base">{event.place}</p>
      <div class="text-gray-500 space-y-1 text-base">
        {event.role ? <p>Rol: {event.role}</p> : null}
        {event.stageDirector ? <p>Dir. Escena: {event.stageDirector}</p> : null}
        {
          event.musicDirector ? (
            <p>Dir. Musical: {event.musicDirector}</p>
          ) : null
        }
      </div>
    </div>

    <div class="text-right">
      <p class="text-lg font-medium text-gray-900">{displayedDate()}</p>
      <div class="flex items-center justify-end gap-3 mt-2">
        <span
          class="inline-block px-2 py-1 bg-gray-100 text-gray-700 text-base rounded"
          >{event.category}</span
        >
        {
          event.eventUrl ? (
            <a
              href={event.eventUrl}
              target="_blank"
              rel="noopener noreferrer"
              class="inline-flex items-center px-3 py-1 bg-gray-900 text-white text-base font-medium rounded hover:bg-gray-800 transition-colors duration-200"
              aria-label={`${actionLabel} ${event.title}`}
            >
              {actionLabel}
              <svg
                class="ml-1 w-3 h-3"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
                />
              </svg>
            </a>
          ) : null
        }
      </div>
    </div>
  </div>
</div>
